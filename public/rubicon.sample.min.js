!function(){const e=window.rubiconSetting||{locale:"en",environment:"devcra"},t="cubic-bezier(0.4, 0, 0.2, 1)",o="https://enhans.new.rubicon.dev.devcra.com";var n,i,c,r,s=!1;const l=new Set,a=document.createElement("div");function d(e){a&&(a.textContent=`[RUBICON] ${e}`)}function u(e){try{return document.evaluate(e,document,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue}catch(t){return console.error("[RUBICON] Failed to get element by xpath:",e,t),null}}if(a.id="rubicon-status-box",a.style.position="fixed",a.style.bottom="10px",a.style.left="10px",a.style.padding="8px 12px",a.style.backgroundColor="rgba(0,0,0,0.8)",a.style.color="white",a.style.fontSize="12px",a.style.fontFamily="monospace",a.style.borderRadius="6px",a.style.zIndex="10000",a.textContent="[RUBICON] idle",document.body.appendChild(a),"devcra"===e.environment){(r=document.createElement("div")).innerHTML='<div class="utility__button__rubicon noitem" data-name="utility__rubicon"><button class="rubicon__button" data-di-id="di-id-8d7c0ff0-62192679"><span class="sr-only">루비콘 버튼</span><svg width="24" height="24" viewBox="0 0 11 11" fill="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#clip0_199_8102)"><path fill-rule="evenodd" clip-rule="evenodd" d="M5.70707 1.73009C5.90225 1.62691 6.03526 1.42184 6.03526 1.1857C6.03526 0.84583 5.75974 0.570312 5.41987 0.570312C5.08 0.570312 4.80449 0.84583 4.80449 1.1857C4.80449 1.42185 4.93751 1.62694 5.13271 1.73011V2.35497H2.85581C2.08494 2.35497 1.46094 2.97897 1.46094 3.74984V7.13446C1.46094 7.90532 2.08494 8.52933 2.85581 8.52933H2.94812V10.1088C2.94812 10.2168 3.0133 10.3142 3.11318 10.3554C3.21307 10.3965 3.32791 10.3734 3.40403 10.2967L5.15863 8.52933H7.98401C8.75488 8.52933 9.37889 7.90532 9.37889 7.13446V3.74984C9.37889 2.97897 8.75488 2.35497 7.98401 2.35497H5.70707V1.73009ZM3.49499 4.67518C3.49499 4.41801 3.70347 4.20954 3.96063 4.20954C4.2178 4.20954 4.42627 4.41801 4.42627 4.67518C4.42627 4.93234 4.2178 5.14082 3.96063 5.14082C3.70347 5.14082 3.49499 4.93234 3.49499 4.67518ZM6.41397 4.67518C6.41397 4.41801 6.62244 4.20954 6.87961 4.20954C7.13677 4.20954 7.34525 4.41801 7.34525 4.67518C7.34525 4.93234 7.13677 5.14082 6.87961 5.14082C6.62244 5.14082 6.41397 4.93234 6.41397 4.67518ZM4.59501 5.89128C4.50025 5.7641 4.32032 5.73782 4.19314 5.83259C4.06596 5.92736 4.03969 6.10728 4.13446 6.23446C4.80109 7.12909 6.15094 7.12909 6.81758 6.23446C6.91235 6.10728 6.88607 5.92736 6.75889 5.83259C6.63171 5.73782 6.45179 5.7641 6.35702 5.89128C5.92007 6.47767 5.03197 6.47767 4.59501 5.89128Z" fill="currentColor"/></g><defs><clipPath id="clip0_199_8102"><rect width="9.84615" height="9.84615" fill="white" transform="translate(0.564453 0.492188)"/></clipPath></defs></svg></button></div>';var m=r.querySelector("button"),h=function(){var e=document.querySelector(".utility__button__cart");return!(!e||!e.parentNode)&&(e.parentNode.insertBefore(r.firstElementChild,e),!0)};if(!h()){var g=new MutationObserver((function(){h()&&g.disconnect()}));g.observe(document.body,{childList:!0,subtree:!0})}m.onclick=()=>f(!1)}function p(){console.log("[RUBICON] initRubicon",{rubiconConfig:e});"1"===localStorage.getItem("rubicon-pending-iframe")&&!s&&(f(!0),localStorage.removeItem("rubicon-pending-iframe"));for(let e=0;e<localStorage.length;e++){const t=localStorage.key(e);if(t&&t.startsWith("rubicon-actions:")){console.log("[RUBICON] found actions:",t);const e=t.split(":")[1];console.log(window.rubicon),window.rubicon.consumeActions(e)}}}function f(o=!1){if(console.log("[RUBICON] _toggleRubicon",{skipAnimation:o}),s=!s){if(document.getElementById("main-content"))return;for((n=document.createElement("div")).id="main-content",n.style.height="100vh",n.style.overflowY="auto",n.style.width="calc(100% - 375px)",n.style.transition=o?"none":"width 0.4s "+t,n.style.position="relative";document.body.firstChild&&document.body.firstChild!==i;)n.appendChild(document.body.firstChild);document.body.appendChild(n),(i=document.createElement("div")).id="aibot-wrapper",i.style.position="fixed",i.style.top="0",i.style.right="0",i.style.height="100vh",i.style.width="375px",i.style.transform="translateX(100%)",i.style.transition=o?"none":"transform 0.4s "+t,i.style.overflowY="hidden",i.style.zIndex="9999";var r=document.createElement("iframe");r.src=function(t=!1){const o=("ko"===e.locale?"https://enhans.new.rubicon.dev.devcra.com":"https://enhans-uk.new.rubicon.dev.devcra.com")+(t?"/?skipIntro=Y":"");return console.log("[RUBICON] RubiconEndpoint",o),o}(o),r.style.width="100%",r.style.height="100%",r.style.border="none",i.appendChild(r),document.body.appendChild(i),(c=document.createElement("div")).id="aibot-divider",c.style.position="fixed",c.style.top="0",c.style.right="375px",c.style.width="2px",c.style.height="100vh",c.style.backgroundColor="#ccc",c.style.zIndex="9998",document.body.appendChild(c),o?i.style.transform="translateX(0)":setTimeout((function(){i.style.transform="translateX(0)"}),10)}else i.style.transform="translateX(100%)",c.remove(),setTimeout((function(){for(;n.firstChild;)document.body.insertBefore(n.firstChild,n);n.remove(),i.remove()}),400)}window.addEventListener("message",(function(e){if(!e||!e.data)return;const{type:t,method:n,args:i}=e.data;if(e.origin===o&&(console.log("[RUBICON] received message:",e.data),"rubicon-command"===t&&window.rubicon&&"function"==typeof window.rubicon[n]))try{console.log(`[RUBICON] iframe command: rubicon.${n}(${(i||[]).join(", ")})`);try{const t=window.rubicon[n](...i||[]);t instanceof Promise?t.then((t=>{e.source.postMessage({type:"rubicon-response",method:n,requestId:e.data.requestId,result:t},e.origin)})).catch((t=>{e.source.postMessage({type:"rubicon-response",method:n,requestId:e.data.requestId,error:String(t)},e.origin)})):e.source.postMessage({type:"rubicon-response",method:n,requestId:e.data.requestId,result:t},e.origin)}catch(e){console.error("[RUBICON] Execution error:",e)}}catch(e){console.error("[RUBICON] Command failed:",n,e)}})),window.rubicon={getMetadata:()=>{const e=window.location.href,t=document.getElementById("main-content"),o=t?t.innerHTML:null;return{locale:locale,currentUrl:e,currentHtml:o}},takeSnapshot:()=>new Promise(((e,t)=>{new Promise(((e,t)=>{if("undefined"!=typeof html2canvas)return e();const o=document.createElement("script");o.src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js",o.onload=e,o.onerror=t,document.head.appendChild(o)})).then((()=>{const o=document.getElementById("main-content")||document.body;html2canvas(o,{useCORS:!0,allowTaint:!0,logging:!1,windowWidth:document.documentElement.scrollWidth,windowHeight:document.documentElement.scrollHeight}).then((t=>{const o=t.toDataURL("image/png");e(o)})).catch((e=>{t(e)}))})).catch(t)})),toggleRubicon:()=>f(!1),openRubicon:e=>{if(console.log("[RUBICON] openRubicon",{initialMessage:e}),!s&&(f(!!e),e)){const t=new MutationObserver((()=>{const n=document.getElementById("aibot-wrapper")?.querySelector("iframe");n&&(t.disconnect(),n.onload=()=>{n.contentWindow.postMessage({type:"send-message",data:e},o)})}));t.observe(document.body,{childList:!0,subtree:!0})}},addActions:(e,t,o=!1)=>{if(console.log("[RUBICON] addActions",{id:e,actions:t,autoRun:o}),"string"==typeof e&&Array.isArray(t))try{localStorage.setItem(`rubicon-actions:${e}`,JSON.stringify(t)),d(`received ${t.length} action(s)`),o&&window.rubicon.consumeActions(e)}catch(e){console.error("[RUBICON] Failed to store actions:",e)}},consumeActions:e=>{if(console.log("[RUBICON] consumeActions",{id:e}),l.has(e))return;const t=localStorage.getItem(`rubicon-actions:${e}`);if(!t)return;const o=JSON.parse(t);if(!o.length)return;s||f(!0),l.add(e),d(`running ${e} (${o.length})`);const n=()=>{const t=o.shift();if(!t)return localStorage.removeItem(`rubicon-actions:${e}`),l.delete(e),void d("idle");localStorage.setItem(`rubicon-actions:${e}`,JSON.stringify(o)),console.log("[RUBICON] consumeActions",{current:t});try{switch(d(`exec ${t.action}`),t.action){case"GO_TO":if(t.value)return void setTimeout((()=>{window.location.href=t.value}),100);break;case"CLICK":{let e=t.selector?document.querySelector(t.selector):null;!e&&t.xpath&&(e=u(t.xpath));const n=!!e;e&&e.click(),0===o.length&&localStorage.setItem("rubicon-pending-iframe","1"),console.log("[RUBICON] CLICK action "+(n?"succeeded":"failed"));break}case"SCROLL":{let e=t.selector?document.querySelector(t.selector):null;!e&&t.xpath&&(e=u(t.xpath));const o=!!e;if(e){e.scrollIntoView({behavior:"smooth",block:"center"});return void new IntersectionObserver(((e,t)=>{e.some((e=>e.isIntersecting))&&(t.disconnect(),console.log("[RUBICON] SCROLL confirmed visible"),setTimeout(n,200))})).observe(e)}console.log("[RUBICON] SCROLL action "+(o?"succeeded":"failed"));break}default:console.warn("Unknown action type:",t.action)}console.log("[RUBICON] consumed action",t.action)}catch(e){console.error("[RUBICON] Action execution failed:",e),d("error")}if(o.length>0)return setTimeout(n,500);localStorage.removeItem(`rubicon-actions:${e}`),l.delete(e),d("done"),setTimeout((()=>d("idle")),1e3)};n()},inspectActions:()=>{const e=[];for(let t=0;t<localStorage.length;t++){const o=localStorage.key(t);if(o&&o.startsWith("rubicon-actions:"))try{const t=JSON.parse(localStorage.getItem(o));e.push({id:o.split(":")[1],actions:t})}catch(e){console.error("[RUBICON] Failed to parse:",o,e)}}console.log("[RUBICON] inspectActions",{entries:e})},clearActions:()=>{console.log("[RUBICON] clearActions");const e=[];for(let t=0;t<localStorage.length;t++){const o=localStorage.key(t);o&&o.startsWith("rubicon-actions:")&&e.push(o)}e.forEach((e=>localStorage.removeItem(e))),console.log(`[RUBICON] Cleared ${e.length} action(s):`,e),d("cleared"),setTimeout((()=>d("idle")),1e3)}},"loading"===document.readyState?window.addEventListener("DOMContentLoaded",p):p()}();